# Version 0.1.0: タイムブロック確認プロトタイプ

## 概要

LLMベースライフマネジメントシステム（KAISHU/ALMS）のVersion 0.1.0は、Googleカレンダー連携とLLMによるタイムブロック生成を核とした基本機能のプロトタイプです。ユーザーの人生目標を階層的に管理し、リアルタイムでタスクを生成する時間オーケストレーションシステムとして設計されています。

### コアコンセプト

- **リアルタイムタスク生成**: 各時間ブロック開始時にLLMとセッションして具体的なタスクを決定
- **動的計画調整**: 体調や状況変化に応じてその日の計画を自動調整
- **時間割ベース管理**: カレンダーに配置されたプロジェクト時間ブロック内での作業内容をセッション時に決定
- **継続的タスク管理**: 未完了タスクの自動引き継ぎとプロジェクトごとのコンテキスト維持

## 機能一覧

### 1. LLM対話機能

- **人生目標ヒアリング**: LLMがユーザーの人生目標を対話形式で聞き取り
- **プロジェクト自動生成**: 目標からプロジェクトを自動作成
- **週次タイムブロック生成**: 1週間分の時間割を自動作成
- **リアルタイム調整**: タイムブロックの即座の更新・修正

### 2. カレンダー連携機能

- **Googleカレンダー同期**: 既存カレンダーとの双方向同期
- **タイムブロック表示**: プロジェクト別の色分け表示
- **衝突検知**: 既存予定との重複回避

### 3. プロジェクト管理機能

- **プロジェクト作成**: 目標ベースのプロジェクト設計
- **時間配分設定**: 週間目標時間の設定
- **ステータス管理**: プロジェクトの進行状況追跡

## 画面イメージ

### ダッシュボード画面

```
┌─────────────────────────────────────────────────────────────┐
│  🏠 KAISHU Dashboard               💬 [LLMチャット]        │
├─────────────────────────────┬───────────────────────────────┤
│  📅 今日のカレンダー  │  📝 現在のプロジェクトタスク           │
│  ┌─────────────────┐  │  ┌─────────────────────────────────┐ │
│  │ 09:00 ▶ 英語学習 │  │  │ ✓ 単語帳アプリ起動 (15分)           │ │
│  │ 10:00   開発作業 │  │  │ 🔵 文法練習 (30分) ← 実行中        │ │
│  │ 12:00   昼食     │  │  │ ⚪ リスニング (15分)               │ │
│  │ 13:00   開発作業 │  │  └─────────────────────────────────┘ │
│  │ 15:00   休憩     │  │                                       │
│  └─────────────────┘  │  ⏱️ 進行中: 文法練習                 │
│                      │  ├ 経過時間: 12分 / 目標30分          │
│                      │  └ 進捗: ████████░░ 40%             │
│                      │                                       │
│                      │  📋 プロジェクトメモ                  │
│                      │  ┌─────────────────────────────────┐ │
│                      │  │ - 今日は発音に重点を置く            │ │
│                      │  │ - 次回は過去形の復習                │ │
│                      │  └─────────────────────────────────┘ │
└─────────────────────┴───────────────────────────────────────┘
```

### プロジェクトリスト画面

```
┌─────────────────────────────────────────────────────────────┐
│  📊 プロジェクト管理                    💬 [LLMチャット]   │
├─────────────────────────────────────────────────────────────┤
│  📋 プロジェクト一覧 & 📈 時間配分グラフ              │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │ プロジェクト名  │週目標│実績│達成率│ステータス         │ │
│  ├─────────────────────────────────────────────────────────┤ │
│  │ 英語能力向上    │ 10h  │ 8h │ 80% │ 🟢 順調           │ │
│  │ 運動習慣確立    │  5h  │ 6h │120% │ 🔵 超過達成       │ │
│  │ Web開発学習     │ 15h  │ 9h │ 60% │ 🟡 要調整         │ │
│  └─────────────────────────────────────────────────────────┘ │
│  🤖 LLMインサイト: 「Web開発の時間確保のため、明日の英語学習   │
│     時間を30分短縮することを提案します」                      │
└─────────────────────────────────────────────────────────────┘
```

### プロジェクト作成画面

```
┌─────────────────────────────────────────────────────────────┐
│               新しいプロジェクト作成                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  📝 プロジェクト基本情報                                    │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │ プロジェクト名 *                                        │ │
│  │ ┌─────────────────────────────────────────────────────┐ │ │
│  │ │ 例: 英語学習プロジェクト                            │ │ │
│  │ └─────────────────────────────────────────────────────┘ │ │
│  │                                                         │ │
│  │ プロジェクトタイプ *                                    │ │
│  │ ○ 学習・スキルアップ  ○ 健康・運動  ○ 仕事・キャリア   │ │
│  │ ○ 趣味・創作        ○ 人間関係    ○ その他           │ │
│  │                                                         │ │
│  │ 目標・ゴール *                                          │ │
│  │ ┌─────────────────────────────────────────────────────┐ │ │
│  │ │ 例: TOEIC 800点達成、日常会話レベルに到達           │ │ │
│  │ └─────────────────────────────────────────────────────┘ │ │
│  │                                                         │ │
│  │ 週間目標時間 *                                          │ │
│  │ ┌──────┐ 時間  ┌──────┐ 分                         │ │
│  │ │  5   │       │  0   │                             │ │
│  │ └──────┘       └──────┘                             │ │
│  │                                                         │ │
│  │ 優先度 *                                                │ │
│  │ ○ 高 (最重要)  ○ 中 (標準)  ○ 低 (余力があれば)       │ │
│  │                                                         │ │
│  │ プロジェクト期間                                        │ │
│  │ 開始日: [2025/01/06 ▼]  終了日: [2025/06/30 ▼]        │ │
│  │                                                         │ │
│  │ 説明・メモ                                              │ │
│  │ ┌─────────────────────────────────────────────────────┐ │ │
│  │ │ プロジェクトの詳細や特記事項があれば記入...         │ │ │
│  │ └─────────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────────┘ │
│                                                             │
│                    [💬 LLMサポート] [✓ 作成] [✗ キャンセル] │
└─────────────────────────────────────────────────────────────┘
```

### タイムブロック生成画面

```
┌─────────────────────────────────────────────────────────────┐
│               週間タイムブロック生成                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  📅 2025年1月6日〜1月12日の週                               │
│                                                             │
│    時間    月    火    水    木    金    土    日           │
│  ┌─────┬─────┬─────┬─────┬─────┬─────┬─────┬─────┐        │
│  │ 06:00│     │     │     │     │     │     │     │        │
│  │ 07:00│英語 │英語 │英語 │英語 │英語 │     │     │        │
│  │ 08:00│学習 │学習 │学習 │学習 │学習 │     │     │        │
│  │ 09:00│─────│─────│─────│─────│─────│─────│─────│        │
│  │ 10:00│開発 │開発 │開発 │開発 │開発 │開発 │     │        │
│  │ 11:00│作業 │作業 │作業 │作業 │作業 │作業 │     │        │
│  │ 12:00│─────│─────│─────│─────│─────│─────│─────│        │
│  │ 13:00│休憩 │休憩 │休憩 │休憩 │休憩 │休憩 │休憩 │        │
│  └─────┴─────┴─────┴─────┴─────┴─────┴─────┴─────┘        │
│                                                             │
│  💬 LLM提案: 「朝の時間を英語学習に、午前中のピーク時間を  │
│     開発作業に割り当てました。土曜日は開発の追加時間、     │
│     日曜日は完全な休息日としています。」                   │
│                                                             │
│  [✓ 承認] [🔄 修正依頼] [💬 詳細相談]                     │
└─────────────────────────────────────────────────────────────┘
```

## 開発フェーズ

### Phase 1: フロントエンドセットアップ・モック作成

**期間**: 1週間  
**目標**: 基本UI構造とモックデータでの動作確認

#### 1.1 開発環境セットアップ

- Next.js 14 + TypeScript プロジェクト作成
- TailwindCSS + shadcn/ui セットアップ
- ESLint/Prettier設定

#### 1.2 基本レイアウト作成

- ヘッダー・サイドバー・メインエリア構成
- レスポンシブデザイン対応
- ダークモード対応

#### 1.3 コンポーネント作成（モック）

- カレンダー表示コンポーネント
- チャットインターフェース
- プロジェクト一覧表示
- タイムブロック表示

#### 1.4 モックデータ作成

- サンプルプロジェクト
- サンプルタイムブロック
- サンプル会話履歴

#### Phase 1 完了条件

- ダッシュボードとプロジェクトリスト画面がモックデータで表示される
- タイムブロックとタスクの基本的な表示が機能する
- モバイル・PC両対応のレスポンシブデザイン
- shadcn/uiコンポーネントライブラリが統合されている
- 基本的なページ間ナビゲーションが動作する

### Phase 2: LLM連携基盤

**期間**: 1週間  
**目標**: LLM APIとの基本的な連携機能

#### 2.1 LLM API連携セットアップ

- OpenAI API統合
- プロンプトテンプレート作成
- エラーハンドリング実装

#### 2.2 対話機能実装

- チャット入力・送信機能
- LLMレスポンス表示
- 会話履歴管理

#### 2.3 基本的なプロンプト実装

- 目標ヒアリングプロンプト
- 簡単な応答生成

#### Phase 2 完了条件

- LLMと基本的な対話ができる
- プロンプトが意図通りに動作する
- エラー時の適切な処理がされる

### Phase 3: データ構造設計・状態管理

**期間**: 1週間  
**目標**: アプリケーションの状態管理とデータ構造確立

#### 3.1 型定義作成

- LifeGoal, GoalCondition, Project, Milestone等の型定義
- TimeBlock, Task, Habit関連の型定義
- LLM会話履歴とAPI レスポンス型定義
- 状態管理用型定義

**主要データ構造（階層関係）:**

```
life_goals (人生目標)
  └── goal_conditions (達成条件)
      └── projects (プロジェクト)
          └── milestones (マイルストーン)
              ├── tasks (タスク)
              └── habits (習慣)
```

#### 3.2 状態管理実装

- Zustand ストア設定
- 人生目標・プロジェクト状態管理
- タイムブロック・タスク状態管理
- 習慣管理状態
- LLM会話履歴状態管理
- プロジェクト間の依存関係管理

#### 3.3 ローカルストレージ実装

- データ永続化
- 初回起動時のデータ復元

#### Phase 3 完了条件

- 型安全なデータ管理ができる
- 状態の更新が正しく反映される
- ページリロード後もデータが保持される

### Phase 4: 目標ヒアリング・プロジェクト生成

**期間**: 1週間  
**目標**: LLMによる目標の聞き取りとプロジェクト自動生成

#### 4.1 目標ヒアリング実装

- 段階的な質問フロー（人生目標→達成条件→プロジェクト化）
- ユーザー回答の構造化と階層化
- 目標の分類・整理（learning, health, work, hobby, relationship等）
- goal_conditionsへの分解ロジック

#### 4.2 プロジェクト生成ロジック

- goal_conditionsからプロジェクトへの変換
- 時間配分の提案（週N時間 or 空き時間のM%）
- マイルストーン設定とフェーズ分割
- プロジェクト間の依存関係設定
- 必要な習慣の提案と統合

#### 4.3 プロジェクト管理UI

- プロジェクト作成・編集画面
- プロジェクト一覧表示
- プロジェクト詳細ビュー

#### Phase 4 完了条件

- LLMが適切な質問でヒアリングできる
- 目標から合理的なプロジェクトが生成される
- 生成されたプロジェクトが管理できる

### Phase 5: タイムブロック生成エンジン

**期間**: 1.5週間  
**目標**: LLMによる最適なタイムブロック生成

#### 5.1 タイムブロック生成ロジック

- プロジェクト優先度の考慮
- 時間制約の処理
- 最適化アルゴリズム実装

#### 5.2 週間スケジュール生成

- 7日間の時間割作成
- プロジェクト間のバランス調整
- 休憩時間の自動配置

#### 5.3 カレンダー表示実装

- 週間ビューの実装
- タイムブロックの視覚的表示
- プロジェクト別の色分け

#### Phase 5 完了条件

- 実用的な週間スケジュールが生成される
- タイムブロックが見やすく表示される
- 生成ロジックが合理的に動作する

### Phase 6: リアルタイム調整機能

**期間**: 1週間  
**目標**: タイムブロックの動的な更新・修正

#### 6.1 調整指示の解釈

- 自然言語での修正依頼処理
- 変更内容の構造化
- 制約チェック

#### 6.2 スケジュール更新ロジック

- 部分的な時間割変更
- 影響範囲の計算
- 自動再調整

#### 6.3 変更履歴管理

- 修正前後の比較表示
- 変更理由の記録
- アンドゥ機能

#### Phase 6 完了条件

- 自然言語でスケジュール調整ができる
- 変更が適切に反映される
- 変更履歴が確認できる

### Phase 7: Googleカレンダー連携

**期間**: 1週間  
**目標**: 外部カレンダーとの双方向同期

#### 7.1 Google Calendar API連携

- 認証フロー実装
- カレンダー読み込み
- イベント作成・更新

#### 7.2 同期ロジック実装

- 既存予定の取得
- 重複チェック
- 双方向同期

#### 7.3 衝突解決機能

- 予定重複の検知
- 自動調整提案
- 手動調整機能

#### Phase 7 完了条件

- Googleカレンダーと正常に同期する
- 既存予定との衝突が適切に処理される
- 変更が双方向で反映される

### Phase 8: 統合テスト・デバッグ

**期間**: 0.5週間  
**目標**: 全機能の統合動作確認

#### 8.1 エンドツーエンドテスト

- 全フローの動作確認
- エラーケースの検証
- パフォーマンステスト

#### 8.2 バグ修正・最適化

- 発見された問題の修正
- UI/UXの改善
- レスポンス速度の最適化

#### Phase 8 完了条件

- 全機能が安定して動作する
- 重大なバグが存在しない
- 実用レベルの性能が確保される

## 技術スタック詳細

### フロントエンド

- **フレームワーク**: Next.js 14 (App Router)
- **言語**: TypeScript
- **スタイリング**: TailwindCSS + shadcn/ui
- **状態管理**: Zustand + TanStack Query
- **チャート**: Recharts + D3.js
- **APIクライアント**: fetch API
- **カレンダー**: FullCalendar.js または自作コンポーネント

### LLM連携

- **Primary API**: OpenAI GPT-4o
- **Fallback API**: Claude 3.5 Sonnet
- **Embedding**: text-embedding-3-small
- **プロンプト管理**: LangChain + 構造化テンプレート
- **エラーハンドリング**: リトライ機能付き
- **コンテキスト管理**: 128k tokens対応

### 外部連携・データ管理

- **カレンダー**: Google Calendar API
- **認証**: Google OAuth 2.0
- **データ永続化**: ローカルストレージ（Version 0.1.0では）
- **将来対応**: PostgreSQL + Prisma（Version 0.2.0以降）

## 成功指標

### 機能的指標

- LLMによる目標ヒアリングの完了率: >90%
- 生成されたタイムブロックの初期受容率: >70%
- カレンダー連携の同期成功率: >95%
- プロジェクト階層化の成功率: >85%

### ユーザビリティ指標

- 初回セットアップ完了時間: <15分
- タイムブロック修正依頼の成功率: >80%
- UIの直感性評価: >4.0/5.0
- プロジェクト作成の完了率: >90%

### 技術的指標

- LLM API応答時間: <3秒
- カレンダー同期時間: <5秒
- フロントエンド初期ロード時間: <2秒
- データ階層管理の整合性: >99%

### データ品質指標

- 人生目標→プロジェクト変換の妥当性: >80%
- タスク引き継ぎの精度: >95%
- 習慣追跡の継続率: >70%
